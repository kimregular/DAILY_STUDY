외부 입력값을 SQL 쿼리에 직접 포함시킬 때, 공격자가 악의적인 SQL 코드를 삽입하여 데이터베이스를 조작하는 공격

- 입력값을 통해 쿼리의 구조를 변경
- 인증 우회, 데이터 조회/변조/삭제

## JSP + JDBC의 경우
```jsp
<%
    String id = request.getParameter("id");
    String pw = request.getParameter("pw");

    Class.forName("com.mysql.jdbc.Driver");
    Connection conn = DriverManager.getConnection(...);
    Statement stmt = conn.createStatement();

    String sql = "SELECT * FROM users WHERE id = '" + id + "' AND pw = '" + pw + "'";
    ResultSet rs = stmt.executeQuery(sql);

    if (rs.next()) {
        out.println("로그인 성공");
    } else {
        out.println("로그인 실패");
    }
%>

```

`id=admin --` 으로 입력값이 들어오면 `--` 이후는 주석처리 되어 ps 조건이 무시됨

## 대응
PrepareStatement 사용
PrepareStatement가 SQL 인젝션을 방어할 수 있는 이유는 입력값과 SQL 쿼리의 구조를 분리하기 때문이다.

- 쿼리구조를 DB에 전달
- 사용자 입력은 문자열 리터럴로 인식됨
`admin --` 으로 입력값이 들어오면 'admin --' 그대로 문자열로 인식되로록 함

```jsp
<%
    String id = request.getParameter("id");
    String pw = request.getParameter("pw");

    Class.forName("com.mysql.jdbc.Driver");
    Connection conn = DriverManager.getConnection(...);

    String sql = "SELECT * FROM users WHERE id = ? AND pw = ?";
    PreparedStatement pstmt = conn.prepareStatement(sql);
    pstmt.setString(1, id);
    pstmt.setString(2, pw);
    
    ResultSet rs = pstmt.executeQuery();

    if (rs.next()) {
        out.println("로그인 성공");
    } else {
        out.println("로그인 실패");
    }
%>

```

