## 이더넷 프레임
지금까지는 물리 계층과 관련된 이더넷 표준과 통신 매체에 대해 알아보았습니다. 이번에는 데이터 링크 계층의 이더넷 프레임을 살펴보겠습니다.

현대 유선 LAN 한경은 대부분 이더넷을 기반으로 구성되므로 호스트가 데이터 링크 계층에서 주고받는 프레임 형식도 정해져 있습니다. 즉, 이더넷 네트워크에서 주고받는 프레임인 이더넷 프레임 형식은 정해져 있습니다.

이더넷 프레임은 상위 계층으로부터 받아들인 정보에 헤더와 트레일러를 추가하는 캡슐화 과정을 통해 만들어집니다. 수신지 입장에서는 프레임의 헤더와 트레일러를 제거한 뒤 상위 계층으로 올려보내는 역캡슐화 과정을 거칩니다.

이더넷 프레임 헤더는 기본적으로 프리앰블, 수신지 MAC 주소, 송신지 MAC 주소, 타입/길이로 구성되고, 페이로드는 데이터, 트레일러는 FCS로 구성됩니다. 이더넷 네트워크에서 통신하는 컴퓨터들은 다음 그림의 정보를 주고받는 셈입니다. 하나씩 살펴봅시다.

![pic_1](https://velog.velcdn.com/images/jjjoina/post/b46e8e4d-eb22-4e45-aa55-9555e154375c/image.png)

### 프리앰블
프리앰블은 이더넷 프레임의 시작을 알리는 8바이트(64비트) 크기의 정보입니다. 프리앰블의 첫 7바이트는 10101010 값을 가지고, 마지막 바이트는 10101011 값을 가집니다. 수신지는 이 프리앰블을 통해 이더넷 프레임이 오고 있음을 알아차립니다. 즉, 프리앰블은 송수지지 간의 동기화를 위해 사용되는 정보입니다.

### 수신지 MAC 주소와 송신지 MAC 주소
이번 절에서 가장 중요한 부분입니다. '물리적 주소'라고도 불리는 MAC 주소는 데이터 링크 계층의 핵심입니다. MAC 주소는 네트워크 인터페이스마다 부여되는 6바이트(48비트) 길이의 주소로, LAN 내의 수신지와 송신지를 특정할 수 있습니다.

같은 네트워크 내에서 동일한 MAC 주소를 가진 기기들이 있다면 송신지와 수신지를 특정할 수 없기에 곤란할 것입니다. 그래서 MAC 주소는 일반적으로 고유하고, 일반적으로 변경되지 않는 주소로써 네트워크 인터페이스마다 부여됩니다. 보통 NIC(Network Interface Controller)라는 장치가 네트워크 인터페이스 역할을 담당합니다. 즉, 한 컴퓨터에 NIC가 여러 개 있다면 MAC 주소도 여러 개 있을 수 있습니다.

필자가 앞에서 '일반적으로 고유한 주소다', '일반적으로 변경되지 않는다'라며 사족을 덧붙인 이유가 있습니다. MAC 주소와 관련한 대표적인 오해 중 하나가 바로 MAC 주소는 '반드시 고유하고 변경이 불가능하다'라는 것입니다.

사실 MAC 주소의 변경이 가능한 경우도 많으며, 따라서 고유하지 않을 수도 있습니다. 다만, 동일 네트워크 내에서 동작하는 기기의 MAC 주소가 우연히 같을 확률은 낮고, 같게 만드는 상황도 흔하지 않습니다. 따라서 MAC 주소를 '일반적으로는 고유하고, 변경되지 않는 주소' 정도로 이해하는 것이 적절합니다.

그럼 여러분 컴퓨터의 MAC 주소를 직접 확인해 볼까요?

윈도우 운영체제 사용자는 명령 프롬프트(CMD)를 열고 `getmac /v` 혹은 `ipconfig /all` 을 입력해보세요.

맥OS나 리눅스 운영체제 사용자는 터미널을 열고 `ifconfig`를 입력해 보세요.

총 48비트, 16진수 열두 자리로 구성되는 것을 확인할 수 있습니다.

### 타입/길이
타입/길이 필드에는 타입 혹은 길이가 올 수 있습니다. 필드에 명시된 크기가 1500(16진수 05DC) 이하일 경우 이 필드는 프레임의 크기(길이)를 나타내는 데 사용도고, 1536(16진수 0600) 이상일 경우에는 타입을 나타내는 데 사용됩니다.

타입이란 이더넷 프레임이 '어떤 정보를 캡슐화했는지'를 나타내는 정보입니다. 이더타입이라고도 부릅니다. 대표적으로 상위 계층에서 사용된 프로토콜의 이름이 명시됩니다. 가령 어떤 프레임이 IPv4 프로토콜이 캡슐화된 정보를 운반한다면 타입에는 16진수 0806이 명시될 것입니다.

| 타입 | 프로토콜 |
| --- | --- |
| 0800 | IPv4 |
| 86DD | IPv6 |
| 0806 | ARP |

이더넷 프레임의 타입은 이외에도 종류가 많으므로 표의 내용을 외울 필요는 없습니다.

### 데이터
데이터는 상위 계층에서 전달받거나 상위 계층으로 전달해야 할 내용입니다. 네트워크 계층의 데이터와 헤더를 합친 PDU가 이곳에 포함됩니다. 최대 크기는 1500바이트로, 유의할 점은 반드시 일정크기(46바이트 이상)여야 한다는 점입니다. 그 이하의 데이터라면 크기를 맞추기 위해 패딩이라는 정보가 내부에 채워집니다. 보통 46바이트 이상이 될 때까지 0으로 채워집니다.

### FCS
FCS(Frame Check Sequence)는 수신한 이더넷 프레임에 오류가 있는지 확인하기 위한 필드입니다. 앞서 데이터 링크 계층에서 오류 검출이 이루어지기도 한다고 했는데, 바로 여기서 오류 검출이 이루어집니다.

이 필드에는 CRC(Cyclic Redundancy Check), 즉 순환 중복 검사라고 불리는 오류 검출용 값이 들어갑니다.

송신지는 프리앰플을 제외한 나머지 필드 값들을 바탕으로 CRC 값을 계산한 후, 이 값을 FCS 필드에 명시합니다. 그리고 수신지는 수신한 프레임에서 프리앰블과 FCS 필드를 제외한 나머지 필드 값들을 바탕으로 CRC 값을 계산한 뒤, 이 값을 FCS 필드 값과 비교합니다. 이때 비교 값이 일치하지 않으면 프레임에 오류가 있다고 판단하여 해당 프레임을 폐기합니다.

![pic_2](https://velog.velcdn.com/images/bapdung/post/64fb478e-bd5b-4e80-b0fd-86cd3a30f2ba/image.png)