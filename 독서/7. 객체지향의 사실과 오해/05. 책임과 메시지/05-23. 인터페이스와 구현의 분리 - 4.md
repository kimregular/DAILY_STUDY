## 캡슐화
객체의 자율성을 보존하기 위해 구현을 외부로부터 감추는 것을 캡슐화라고 한다. 객체는 상태와 행위를 함께 캡슐화함으로써 충분히 협력적이고 만족스러울 정도로 자율적인 존재가 될 수 있다. 캡슐화를 정보 은닉이라고 부르기도 한다.

객체지향의 세계에서 캡슐화는 두 가지 관점에서 사용된다.

- 상태와 행위의 캡슐화
- 사적인 비밀의 캡슐화

### 상태와 행위의 캡슐화
객체는 상태와 행위의 조합이다. 객체는 스스로 자신의 상태를 관리하며 상태를 변경하고 외부에 응답할 수 있는 행동을 내부에 함께 보관한다. 객체는 상태와 행동을 하나의 단위로 묶는 자율적인 실체다. 이 관점에서의 캡슐화를 데이터 캡슐화라고 한다.

객체는 상태와 행위를 한데 묶은 후 외부에서 반드시 접근해야만 하는 행위만 골라 공용 인터페이스를 통해 노출한다. 따라서 데이터 캡슐화는 인터페이스와 구현을 분리하기 위한 전제 조건이다. 객체가 자율적이기 위해서는 자기 자신의 상태를 스스로 관리할 수 있어야 하기 때문에 데이터 캡슐화는 자율적인 객체를 만들기 위한 전제 조건이기도 하다.

프로그래밍 관점에서 상태는 주로 데이터로 구현되고 행동은 프로세스로 구현된다. 과거의 전통적인 개발 방법은 데이터와 프로세스를 엄격하게 구분하지만 객체지향에서는 데이터와 프로세스를 객체라는 하나의 틀 안으로 함께 묶어 놓음으로써 객체의 자율성을 보장한다. 이것이 전통적인 개발 방법과 객체지향을 구분 짓는 가장 중요한 차이다.

### 사적인 비밀의 캡슐화
사람들은 자신만의 개인적인 내용이나 공간에 외부인이 함부로 침입할 수 없도록 최대한 방어한다. 아침에 출근하기 위해 집을 나설 때 문이 잘 잠겨 있는지 반드시 확인하고 타인이 함부로 메일을 엿볼 수 없도록 아이디와 패스워드를 설정한다.

보안에 민감한 것은 사람만이 아니다. 객체 역시 개인적인 비밀이 노출되는 것에 민감하다. 객체는 외부의 객체가 자신의 내부 상태를 직접 관찰하거나 제어할 수 없도록 막기 위해 의사소통 가능한 특별한 경로만 외부에 노출한다. 이처럼 외부에서 객체와 의사소통할 수 있는 고정된 경로를 공용 인터페이스라고 한다.

캡슐화를 통해 변경이 빈번하게 일어나는 불안정한 비밀을 안정적인 인터페이스 뒤로 숨길 수 있다. 일반적으로 불안정한 비밀은 구현과 관련된 세부 상항을 의미한다.

객체의 공용 인터페이스는 외부에서 전송 가능한 메시지의 집합이다. 외부 객체는 오직 공용 인터페이스에 정의된 메시지를 통해서만 객체에 접근할 수 있다. 외부에 제공해야 할 필요가 있는 메시지만을 객체의 공용 인터페이스에 포함시키고 개인적인 비밀은 공용 인터페이스의 뒤에 감춤으로써 외부의 불필요한 공격과 간섭으로부터 내부 상태를 격리할 수 있다. 따라서 객체는 공용 인터페이스를 경계로 최대한의 자율성을 보장받을 수 있다.

실세계에서 자율성이란 자기 자신의 사적인 부분을 외부의 간섭 없이 변경할 수 있음을 의미한다. 객체 역시 마찬가지다. 자율적인 객체는 공용 인터페이스를 수정하지 않는 한 자신과 협력하는 외부 객체에 영향을 미치지 않고 내부의 구현을 자유롭게 수정할 수 있다. 이것은 인터페이스와 구현의 분리 원칙과도 연결된다. 따라서 구현을 변경할 때 외부에 대한 파급효과를 최소화하기 위해서는 외부의 객체는 공용 인터페이스에만 의존해야 하고 구현 세부 사항에 대해서는 직접적으로 의존해서는 안 된다.

객체를 자율적인 존재로 바라보는 것은 결국 객체의 내부와 외부를 엄격하게 분리한다는 것을 의미한다. 객체는 자신의 의지에 따라 변경하고 조작할 수 있는 비밀을 가지고 있다. 이것은 객체의 내부다. 동시에 객체는 외부의 객체가 의지하고 접근할 수 있는 공용 인터페이스를 가진다. 이것은 객체의 외부다. 어떤 것도 동시에 객체의 내부와 외부에 포함될 수 없다.

객체지향은 내부와 외부를 명확하게 구분하는 객체들로 구성된 협력 공동체다. 객체지향이 과거의 개발 방법에 비해 좀 더 유연하고 재사용 가능하다고 알려진 이유는 객체의 내부와 외부를 명확하게 구분하기 때문이다. 객체의 외부와 내부를 명확하게 구분하라. 그러면 설계가 단순하고 유연하고 변경하기 쉬워질 것이다.

이제 전체적인 정리를 위해 객체가 자율적인 책임을 가지는 것이 왜 중요한지에 관해 설명하는 것으로 이번 장을 마치겠다. 책임을 결정하는 것은 메시지라는 것을 기억하라. 따라서 자율적인 책임의 특성은 자율적인 책임을 수행하게 하는 메시지의 특성과도 연결된다.