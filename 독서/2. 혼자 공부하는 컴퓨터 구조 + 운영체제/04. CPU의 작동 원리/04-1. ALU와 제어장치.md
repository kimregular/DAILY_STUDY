CPU는 저장된 명령어를 읽어 들이고, 해석하고, 실행하는 장치이다. 그리고 CPU 내부에는 계산을 담당하는 ALU, 명령어를 읽어 들이고 해석하는 제어장치, 작은 임시 저장 장치인 레지스터라는 구성 요소가 있다.

## ALU

아래 그림은 ALU가 어떤 정보를 받아드리고 내보내는지를 표현한 그림이다.

![‎ALU와 제어장치.‎001](file:///Users/regularkim/Library/Mobile%20Documents/com~apple~CloudDocs/Typora/%E1%84%82%E1%85%A9%E1%84%89%E1%85%A7%E1%86%AB%E1%84%8B%E1%85%A5%E1%86%B8%E1%84%85%E1%85%A9%E1%84%83%E1%85%B3%E1%84%8B%E1%85%AD%E1%86%BC/CS/%E2%80%8EALU%E1%84%8B%E1%85%AA%20%E1%84%8C%E1%85%A6%E1%84%8B%E1%85%A5%E1%84%8C%E1%85%A1%E1%86%BC%E1%84%8E%E1%85%B5.%E2%80%8E001.jpeg?lastModify=1694360151)

먼저 ALU가 받아들이는 정보부터 알아보자. ALU는 계산하는 부품이다. 계산을 하기 위해서는, 예를 들어 1+2를 한다고 했을 때, 1과 2라는 피연산자와 더하기라는 수행할 연산이 필요하다. 이렇듯이 ALU가 계산을 하기 위해서는 피연산자와 수행할 연산이 필요하다.

그래서 `ALU`는 레지스터를 통해 `피연산자`를 받아들이고, 제어장치로부터 수행할 연산을 알려주는 `제어신호`를 받아들인다. ALU는 레지스터와 제어장치로부터 받아들인 피연산자와 제어 신호로 산술연산, 논리연산 등 다양한 연산을 수행한다.

다음으로 ALU가 내보내는 정보를 알아보자. 연산을 수행한 결과는 특정 숫자나 문자가 될 수도 있고, 메모리 주소가 될 수도 있다. 그리고 이 결과값은 바로 메모리에 저장되지 않고 일시적으로 레지스터에 저장된다.

CPU가 메모리에 접근하는 속도는 레지스터에 접근하는 속도보다 훨씬 느리다. ALU가 연산할 때마다 결과를 메모리에 저장한다면 당연하게도 CPU는 메모리에 자주 접근하게 되고, 이는 CPU가 프로그램 실행 속도를 늦출 수 있다. 그래서 ALU의 결과값을 메모리가 아닌 레지스터에 우선 저장한다.

맨처음 그림을 보면 결과값 외에도 ALU는 또 다른 정보를 내보낸다. ALU는 계산 결과와 더불어 `플래그` 를 내보낸다. 이전 이진수 부분에서 이진수의 음수, 양수를 구분할 때 플래그를 사용한다라고 언급했다. 이처럼 때때로 ALU는 결과값뿐만 아니라 연산 결과에 대한 추가적인 정보를 내보내야 할 때가 있다. 가령 연산 결과가 음수일 때 ALU는 '방금 계산한 결과는 음수' 라는 추가 정보를 내보낸다. 혹은 연산 결과가 연산 결과를 담을 레지스터 보다 클 때 ALU는 '결과값이 너무 크다1' 라는 추가 정보를 내보낸다.

이렇게 연산 결과에 대한 추가적인 상태 정보를 `플래그(flag)` 라고 한다. ALU 가 내보내는 대표적인 플래그는 아래와 같다.

|플래그 종류|의미|사용 예시|
|---|---|---|
|부호 플래그|연산한 결과의 부호를 나타낸다|부호 플래그가 1일 경우 계산 결과는 음수, 0일 경우 계산 결과는 양수를 의미한다|
|제로 플래그|연산 결과가 0인지 여부를 나타낸다|제로 플래그가 1일 경우 연산 결과는 0, 0일 경우 연산 결과는 0이 아님을 의미한다|
|캐리 플래그|연산 결과 올림수나 빌림수가 발생했는지를 나타낸다|캐리 플래그가 1일 경우 올림수나 빌림수가 발생했음을 의미하고, 0일 경우 발생하지 않았음을 의미한다|
|오버플로우 플래그|오버플로우가 발생했는지를 나타낸다|오버플로우 플래그가 1일 경우 오버플로우가 발생했음을 의미하고, 0일 경우 발생하지 않았음을 의마한다|
|인터럽트 플래그|인터럽트가 가능한지를 나타낸다|인터럽트 플래그가 1일 경우 인터럽트가 가능함을 의미하고, 0일 경우 인터럽트가 불가능함을 의미한다|
|슈퍼바이저 플래그|커널 모드로 실행 중인지, 사용자 모드로 실행 중인지를 나타낸다|슈퍼바이저 플래그가 1일 경우 커널 모드로 실행 중임을 의미하고, 0일 경우 사용자 모드로 실행 중임을 의미한다|

이러한 플래그는 CPU가 프로그램을 실행하는 도중 반드시 기억해야 하는 일종의 참고 정보이다. 그리고 플래그들은 `플래그 레지스터` 라는 레지스터에 저장된다. 플래그 레지스터는 이름 그대로 플래그 값들을 저장하는 레지스터이다. 이 레지스터를 읽으면 연산 결과에 대한 추가적인 정보, 참고 정보를 얻을 수 있다.

예를 들어 플래그 레지스터가 아래와 같은 구조를 가지고 있고, ALU가 연산을 수행한 직후 부호 플래그가 1이 되었다면 연산 결과는 음수임을 알 수 있다.

![‎ALU와 제어장치.‎002](file:///Users/regularkim/Library/Mobile%20Documents/com~apple~CloudDocs/Typora/%E1%84%82%E1%85%A9%E1%84%89%E1%85%A7%E1%86%AB%E1%84%8B%E1%85%A5%E1%86%B8%E1%84%85%E1%85%A9%E1%84%83%E1%85%B3%E1%84%8B%E1%85%AD%E1%86%BC/CS/%E2%80%8EALU%E1%84%8B%E1%85%AA%20%E1%84%8C%E1%85%A6%E1%84%8B%E1%85%A5%E1%84%8C%E1%85%A1%E1%86%BC%E1%84%8E%E1%85%B5.%E2%80%8E002.jpeg?lastModify=1694360115)

또한 만약 ALU가 연산을 수행한 직후 플래그 레지스터가 아래와 같다면 제로 플래그가 1이 되었으니 연산 결과는 0임을 알 수 있다.

![‎ALU와 제어장치.‎003](file:///Users/regularkim/Library/Mobile%20Documents/com~apple~CloudDocs/Typora/%E1%84%82%E1%85%A9%E1%84%89%E1%85%A7%E1%86%AB%E1%84%8B%E1%85%A5%E1%86%B8%E1%84%85%E1%85%A9%E1%84%83%E1%85%B3%E1%84%8B%E1%85%AD%E1%86%BC/CS/%E2%80%8EALU%E1%84%8B%E1%85%AA%20%E1%84%8C%E1%85%A6%E1%84%8B%E1%85%A5%E1%84%8C%E1%85%A1%E1%86%BC%E1%84%8E%E1%85%B5.%E2%80%8E003.jpeg?lastModify=1694360115)

이외에도 ALU 내부에는 여러 계산을 위한 회로들이 있다. 대표적으로 덧셈을 위한 가산기, 뺄샘을 위한 보수기, 시프트 연산을 수행하는 시프터, 오버플로우를 대비한 오버플로우 검출기 등이 있다.

## 제어장치

제어장치를 알아보자. `제어장치` 는 제어 신호를 내보내고, 명령어를 해석하는 부품이다. 그리고 `제어신호` 는 컴퓨터 부품들을 관리하고 작동시키기 위한 일종의 전기 신호이다.

제어장치는 CPU의 구성 요소 중 가장 정교하게 설계된 부품이다. 그래서 CPU 제조사마다 제어장치의 구현 방식이나 명령어를 해석하는 방식, 받아들이고 내보내는 정보에는 조금씩 차이가 있다.

아래는 제어장치가 무엇을 받아들이고, 무엇을 내보내는지를 나타낸 그림이다.

![‎ALU와 제어장치.‎001](file:///Users/regularkim/Library/Mobile%20Documents/com~apple~CloudDocs/Typora/%E1%84%82%E1%85%A9%E1%84%89%E1%85%A7%E1%86%AB%E1%84%8B%E1%85%A5%E1%86%B8%E1%84%85%E1%85%A9%E1%84%83%E1%85%B3%E1%84%8B%E1%85%AD%E1%86%BC/CS/%E2%80%8EALU%E1%84%8B%E1%85%AA%20%E1%84%8C%E1%85%A6%E1%84%8B%E1%85%A5%E1%84%8C%E1%85%A1%E1%86%BC%E1%84%8E%E1%85%B5.%E2%80%8E001-4089476.jpeg?lastModify=1694360115)

### 클럭

제어장치는 `클럭(clock)` 신호를 받아들인다. 클럭이란 컴퓨터의 모든 부품을 일사불란하게 움직일 수있게 하는 시간 단위이다. 클럭의 "똑-딱-똑-딱" 주기에 맞춰 한 레지스터에서 다른 레지스터로 데이터가 이동되거나, ALU에서 연산이 수행되거나, CPU가 메모리에 저장된 명령어를 읽어들인다.

다만,

> 컴퓨터의 모든 부품이 클럭 신호에 맞춰 작동한다 != 컴퓨터의 모든 부품이 한 클럭마다 작동한다

위처럼 이해해야 한다. 컴퓨터 부품들은 클럭이라는 박자에 맞춰 작동할 뿐 한 박자마다 작동하지는 않는다. 하나의 명령어가 여러 클럭에 걸쳐 실행될 수 있다.

### 제어장치가 받아들이는 정보

1. 해석해야하는 명령어
    
    제어장치는 해석해야하는 명령어를 받아들인다. CPU가 해석해야 할 명령어는 `명령어 레지스터` 라는 특별한 레지스터에 저장된다. 제어장치는 이 명령어 레지스터로부터 해석할 명령어를 받아들이고 해석한 뒤, 제어 신호를 발생시켜 컴퓨터 부품들에 수행해야 할 내용을 알려준다.
    
2. 플래그값
    
    제어장치는 플래그 레지스터 속 플래그 값을 받아들인다. 플래그는 ALU 연산에 대한 추가적인 상태 정보이다. 제어장치가 제어 신호를 통해 컴퓨터 부품들을 제어할 때 이 중요한 참고 사항을 무시해서는 안 된다. 그렇기에 제어장치는 플래그 값을 받아들이고 이를 참고하여 제어 신호를 발생시킨다.
    
3. 제어 신호
    
    제어장치는 시스템 버스, 그중에서 제어 버스로 전달된 제어 신호를 받아들인다. 제어 신호는 CPU 뿐만 아니라 입출력장치를 비롯한 CPU 외부 장치도 발생시킬 수 있다. 제어장치는 제어 버스를 통해 외부로부터 전달된 제어 신호를 받아들이기도 한다.
    

### 제어장치가 내보내는 정보

1. CPU 내부로 내보내는 정보
    
    제어장치가 CPU 내부에 전달하는 제어신호에는 크게 `ALU에 전달하는 제어 신호`와 `레지스터에 전달하는 제어 신호`가 있다. ALU에는 수행할 연산을 지시하기 위해, 레지스터에는 레지스터 간에 데이터를 이동시키거나 레지스터에 저장된 명령어를 해석하기 위해 제어신호를 내보낸다.
    
2. CPU 외부로 내보내는 정보
    
    제어장치가 CPU 외부에 제어신호를 전달한다는 말은 곧, 제어 버스로 제어신호를 내보낸다는 말과 같다. 이러한 제어신호에는 크게 메모리에 전달하는 제어신호와 입출력장치에 전달하는 제어신호가 있다.
    
    제어장치가 메모리에 저장된 값을 읽거나 메모리에 새로운 값을 쓰고 싶다면 메모리로 제어신호를 내보낸다. 그리고 제어장치가 입출력장치의 값을 읽거나 입출력장치에 새로운 값을 쓰고 싶을 때는 입출력장치로 제어신호를 내보낸다.
    

---

[1]  연산 결과가 연산 결과를 담을 레지스터보다 큰 상황을 overflow라고 한다.