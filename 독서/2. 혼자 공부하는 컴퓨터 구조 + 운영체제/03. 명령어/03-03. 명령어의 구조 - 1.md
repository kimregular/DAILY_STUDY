# 명령어의 구조 - 1

기계어나 어셈블리어를 이루는 하나하나가 명령어이다. 아직 각각의 명령어는 자세히 살펴보지 않았다. 이제 살펴보도록 하자.

## 연산 코드와 오퍼랜드

누군가에게 명령을 할 때는 대개 아래와 같다.

"다음주까지 과제를 제출해라"

컴퓨터 속 명령어도 마찬가지다. 명령어는 '무엇을 대상으로, 어떤 작동을 수행하라'는 구조로 되어 있다. 아래 표를 보면 가장 왼쪽 필드는 명령어의 '작동', 다시말해 '연산'을 담고있다. 그리고 중간과 오른쪽은 '연산에 사용할 데이터' 또는 '연산에 사용할 데이터가 저장된 위치' 를 담고 있다.

|더해라|100과|120을|
|---|---|---|
|빼라|메모리 32번지 안의 값과|메모리 33번지 안의 값을|
|저장해라|10을|메모리 128번지에|

`명령어` 는 `연산 코드`와 `오퍼랜드`로 구성된다. 가장 왼쪽 값, 즉 '명령어가 수행할 연산' 을 `연산코드(operation code)` 라 하고, 중간과 오른쪽 필드값, 즉 '연산에 사용할 데이터' 또는 '연산에 사용할 데이터가 저장된 위치' 를 `오퍼랜드(operand)` 라고 한다. 연산 코드는 `연산자`, 오퍼랜드는 `피연산자` 라고도 부른다.

간단하게 표현하면 아래의 표와 같다. 위 표와 마찬가지로 가장 왼쪽, 즉 연산 코드가 담기는 영역을 `연산 코드 필드` 라고 부르고, 오른쪽, 즉 오퍼랜드가 담기는 영역을 `오퍼랜드 필드` 라고 부른다.

|연산 코드|오퍼랜드|
|---|---|

기계어와 어셈블리어 또한 명령어이기 때문에 연산 코드와 오퍼랜드로 구성된다. 좌측 글씨가 연산 코드, 탭 이후 글씨가 오퍼랜드이다.

```
push    rbp  
​  
mov     rbp, rsp  
​  
mov     DWORD PTR [rbp-4], 1  
​  
mov     DWORD PTR [rbp-8], 2  
​  
mov     edx, DWORD PTR [rbp-4]  
​  
mov     eax, DWORD PTR [rbp-8]  
​  
add     eax, edx  
​  
mov     DWORD PTR [rbp-12], eax  
​  
mov     eax, 0  
​  
pop     rbp  
​  
ret
```

### 오퍼랜드

명령어를 이루는 연산 코드와 오퍼랜드 중 오퍼랜드부터 알아본다.

오퍼랜드는 '연산에 사용할 데이터' 또는 '연산에 사용할 데이터가 저장된 위치' 를 의미한다. 그래서 오퍼랜드 필드에는 숫자와 문자 등을 나타내는 데이터 또는 메모리나 레지스터 주소가 올 수 있다. 다만 오퍼랜드 필드에는 숫자나 문자와 같이 연산에 사용할 데이터를 직접 명시하기보다는, 많은 경우 연산에 사용할 데이터가 저장된 위치, 즉 메모리 주소나 레지스터 이름이 담긴다. 그래서 오퍼랜드 필드를 `주소 필드` 라고 부르기도 한다.

오퍼랜드는 명령어 안에 하나도 없을 수도 있고, 한 개만 있을 수도 있고, 두 개 또는 세 개 등 여러개가 있을 수도 있다.

```
mov     eax, 0

오퍼랜드가 한 개인 경우

pop     rbp

오퍼랜드가 두 개인 경우

ret

오퍼랜드가 없는 경우
```
​

여기서 오퍼랜드가 하나도 없는 명령어를 `0-주소 명령어` 라고 하고, 오퍼랜드가 하나인 명령어를 `1-주소 명령어` , 두 개인 명령어를 `2-주소 명령어` , 3개인 명령어를 `3-주소 명령어` 라고 한다.

1. 오퍼랜드가 없는 경우 (0-주소 명령어)

|연산코드|
|---|

2. 오퍼랜드가 한 개인 경우 (1-주소 명령어)

|연산코드|오퍼랜드|
|---|---|

1. 오퍼랜드가 두 개인 경우 (2-주소 명령어)

|연산코드|오퍼랜드|오퍼랜드|
|---|---|---|

2. 오퍼랜드가 세 개인 경우 (3-주소 명령어)

|연산코드|오퍼랜드|오퍼랜드|오퍼랜드|
|---|---|---|---|

### 연산코드

연산 코드는 명령어가 수행할 연산을 의미한다. 연산 코드 종류는 매우 많지만, 가장 기본적인 연산 코드 유형은 크게 네 가지로 나눌 수 있다.

3. 데이터 전송
4. 산술/논리 연산
5. 제어 흐름 변경
6. 입출력 제어

이 네 가지 유형 각각에 해당하는 대표적인 연산 코드를 알아보자.

7. 데이터 전송
    - MOVE : 데이터를 옮겨라
    - STORE : 메모리에 저장해라
    - LOAD (FETCH) : 메모리에서 CPU로 데이터를 가져와라
    - PUSH : 스택에 데이터를 저장해라
    - POP : 스택의 최상단 데이터를 가져와라
8. 산술/논리 연산
    - ADD/SUBTRACT/MULTIPLY/DIVIDE : 덧셈/뺄셈/곱셈/나눗셈을 수행해라
    - INCREMENT/DECREMENT : 오퍼랜드에 1을 더해라 / 오퍼랜드에 1을 빼라
    - AND/OR/NOT: 'AND' 연산, 'OR' 연산, 'NOT' 연산을 수행해라
    - COMPARE : 두 개의 숫자 또는 TRUE/FALSE 값을 비교해라
9. 제어 흐름 변경
    - JUMP : 특정 주소로 실행 순서를 옮겨라
    - CONDITIONAL JUMP : 조건에 부합할 때 특정 주소로 실행 순서를 옮겨라
    - HALT : 프로그램의 실행을 멈춰라
    - CALL : 되돌아올 주소를 저장한 채 특정 주소로 실행 순서를 옮겨라
    - RETURN : CALL을 호출 할 때 저장했던 주소로 돌아가라
10. 입출력 제어
    - READ (INPUT) : 특정 입출력 장치로부터 데이터를 읽어라
    - WRITE (OUTPUT) : 특정 입출력 장치로 데이터를 써라
    - START IO : 입출력 장치를 시작해라
    - TEST IO : 입출력 장치의 상태를 확인해라
